<!doctype html><html lang=en class=h-100><head><title>Synchronization | Mutagen</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" href=/img/favicon.png><script src=/js/bundle.3aeab2414d60a7503e5e48309329f68fc244713a80665f3baba323d52f60b764.js integrity="sha256-OuqyQU1gp1A&#43;Xkgwkyn2j8JEcTqAZl87q6Mj1S9gt2Q="></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mukta|Roboto:300,400|Roboto+Mono"><link rel=stylesheet href=/scss/main.min.6cd9493828aaf9946db37459e87631b3e2fa26d368112903942cdcab8dcb259f.css integrity="sha256-bNlJOCiq&#43;ZRts3RZ6HYxs&#43;L6JtNoESkDlCzcq43LJZ8="></head><body class="d-flex flex-column h-100"><div class=flex-shrink-0><nav class="navbar navbar-expand-md navbar-light py-0"><div class=container><a class="navbar-brand mutagen-brand" href=/><img class="d-inline-block align-top logo" src=/img/logo.svg alt="Mutagen logo">
Mutagen</a>
<button class="navbar-toggler mr-2" type=button data-toggle=collapse data-target=#navigation-content aria-controls=navigation-content aria-expanded=false aria-label="Toggle navigation" style=border:none>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navigation-content><ul class="navbar-nav ml-auto"><li class="nav-item mr-3"><a class=nav-link href=/documentation/introduction/installation>Install</a></li><li class="nav-item mr-3"><a class=nav-link href=/documentation>Documentation</a></li><li class="nav-item mr-3"><a class=nav-link href=https://spectrum.chat/mutagen target=_blank>Spectrum</a></li><li class="nav-item mr-3"><a class=nav-link href=https://twitter.com/mutagen_io target=_blank>Twitter</a></li><li class=nav-item><a class=nav-link href=https://github.com/mutagen-io/mutagen target=_blank>GitHub</a></li></ul></div></div></nav><nav class="navbar navbar-expand-md navbar-dark bg-dark py-0"><div class=container><div class="collapse navbar-collapse" id=navigation-content><ul class="navbar-nav ml-auto"><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=introduction-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Introduction</a><div class=dropdown-menu aria-labelledby=introduction-dropdown><a class=dropdown-item href=/documentation/introduction>Overview</a>
<a class=dropdown-item href=/documentation/introduction/installation>Installation</a>
<a class=dropdown-item href=/documentation/introduction/getting-started>Getting started</a>
<a class=dropdown-item href=/documentation/introduction/daemon>Daemon</a>
<a class=dropdown-item href=/documentation/introduction/configuration>Configuration</a>
<a class=dropdown-item href=/documentation/introduction/names-labels-identifiers>Names, labels, and identifiers</a></div></li><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=transports-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Transports</a><div class=dropdown-menu aria-labelledby=transports-dropdown><a class=dropdown-item href=/documentation/transports>Overview</a>
<a class=dropdown-item href=/documentation/transports/local>Local</a>
<a class=dropdown-item href=/documentation/transports/ssh>SSH</a>
<a class=dropdown-item href=/documentation/transports/docker>Docker<sup>Â®</sup> containers</a></div></li><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=synchronization-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Synchronization</a><div class=dropdown-menu aria-labelledby=synchronization-dropdown><a class=dropdown-item href=/documentation/synchronization>Overview</a>
<a class=dropdown-item href=/documentation/synchronization/ignores>Ignores</a>
<a class=dropdown-item href=/documentation/synchronization/version-control-systems>Version control systems</a>
<a class=dropdown-item href=/documentation/synchronization/permissions>Permissions</a>
<a class=dropdown-item href=/documentation/synchronization/symbolic-links>Symbolic links</a>
<a class=dropdown-item href=/documentation/synchronization/watching>Watching</a>
<a class=dropdown-item href=/documentation/synchronization/probing-and-scanning>Probing and scanning</a>
<a class=dropdown-item href=/documentation/synchronization/staging>Staging</a>
<a class=dropdown-item href=/documentation/synchronization/size-limits>Size limits</a>
<a class=dropdown-item href=/documentation/synchronization/safety-mechanisms>Safety mechanisms</a></div></li><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=forwarding-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Forwarding</a><div class=dropdown-menu aria-labelledby=forwarding-dropdown><a class=dropdown-item href=/documentation/forwarding>Overview</a>
<a class=dropdown-item href=/documentation/forwarding/unix-domain-sockets>Unix domain sockets</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=orchestration-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Orchestration</a><div class=dropdown-menu aria-labelledby=orchestration-dropdown><a class=dropdown-item href=/documentation/orchestration>Overview</a>
<a class=dropdown-item href=/documentation/orchestration/configuration>Configuration</a>
<a class=dropdown-item href=/documentation/orchestration/example>Example</a></div></li></ul></div></div></nav><div class="container my-5"><div class=row><div class="d-none d-lg-block col-lg-3"><div class="sticky-top padded-sticky-top"><nav id=TableOfContents><ul><li><a href=#synchronization>Synchronization</a><ul><li><a href=#design-and-architecture>Design and architecture</a></li><li><a href=#modes>Modes</a><ul><li><a href=#conflict-resolution>Conflict resolution</a></li></ul></li><li><a href=#endpoint-urls>Endpoint URLs</a></li><li><a href=#configuration>Configuration</a></li><li><a href=#session-management>Session management</a></li></ul></li></ul></nav></div></div><div id=content class="col-md-12 col-lg-9 mb-3"><h1 id=synchronization>Synchronization</h1><div class="d-none d-md-block float-right w-50 ml-3"><img class=w-100 src=/img/skeleton_editor.svg></div><p>Mutagen&rsquo;s synchronization sessions use a novel algorithm that combines the
performance of the
<a href=https://www.samba.org/~tridge/phd_thesis.pdf>rsync algorithm</a> with
bidirectionality and low-latency filesystem watching. It can be used (for
example) to synchronize code between your laptop and a remote container in
effective real-time, allowing you to edit code with your editor of choice and
have it pushed to the remote environment almost instantly. Because it uses
differential transfers, Mutagen&rsquo;s synchronization also works effectively for
transferring large binary files such as images or build artifacts.</p><h2 id=design-and-architecture>Design and architecture</h2><p>Mutagen&rsquo;s synchronization sessions each operate between an arbitrary pair of
endpoints, termed <strong>alpha</strong> and <strong>beta</strong>. The reason that these endpoints aren&rsquo;t
termed &ldquo;source&rdquo; and &ldquo;destination&rdquo; is that Mutagen has multiple synchronization
modes, including bidirectional modes, where these terms don&rsquo;t necessarily apply.
Thus, the order of endpoints provided to the <code>mutagen sync create</code> command
simply establishes these <em>identities</em> (with the first endpoint being alpha and
the second being beta), whereas the <em>roles</em> of these endpoints are determined by
the <a href=#modes>synchronization mode</a>.</p><p>Synchronization sessions are extremely flexible, allowing both endpoints to be
local, one to be local and one to be remote, or both to be remote (in which case
the local system is simply used as a proxy and controller for synchronization).
This flexible topology, combined with the myriad
<a href=#configuration>synchronization configuration</a> options, allows users to create
arbitrarily complex synchronization topologies.</p><p>Internally, the synchronization algorithm uses a three-way merge to reconcile
changes from both endpoints in a safe and controlled fashion. This means that
synchronization sessions track the most-recently agreed-upon content and use
that information to detect the changes that each endpoint has made, as well as
any conflicts. This algorithm operates in short cycles, with every filesystem
change triggering a cycle. Each cycle consists of a scan of both endpoints,
a reconciliation of endpoint contents, staging of updated contents from one
endpoint to another, and application of changes. These cycles are designed to be
extremely efficient, to the point of being imperceptibly fast for most content
and changes.</p><h2 id=modes>Modes</h2><p>Mutagen provides four different synchronization modes:</p><ul><li><strong><code>two-way-safe</code> (Default)</strong>: In this bidirectional synchronization mode, both
endpoints are treated with equal precedence, and conflicts are only
automatically resolved if they don&rsquo;t result in data loss (e.g. modifications
on one endpoint can can overwrite deletions of the corresponding content on
the other endpoint). If conflicts can&rsquo;t be automatically resolved, they are
stored in the session state (and can be enumerated with the
<code>mutagen sync list</code> command).</li><li><strong><code>two-way-resolved</code></strong>: This is the same as <code>two-way-safe</code>, except that the
alpha endpoint automatically wins all conflicts, including cases where alpha&rsquo;s
deletions would overwrite beta&rsquo;s modifications or creations. No conflicts can
occur in this synchronization mode.</li><li><strong><code>one-way-safe</code></strong>: In this unidirectional synchronization mode, changes are
only allowed to propagate from alpha to beta. Deletions on beta are
overwritten by content from alpha (i.e. the content comes right back), but
modifications and creations on beta can&rsquo;t be overwritten by alpha (unless both
endpoints have made the same modifications or created the same content).
Conflicting contents on beta that can&rsquo;t be overwritten will be recorded to the
session state (and can be enumerated with the <code>mutagen sync list</code> command).
Extra content on beta that doesn&rsquo;t conflict with contents on alpha is simply
ignored.</li><li><strong><code>one-way-replica</code></strong>: In this unidirectional synchronization mode, beta
becomes an exact replica of alpha. Any modifications or additional content on
beta are instantly overwritten or removed, respectively. No conflicts can
occur in this synchronization mode.</li></ul><p>You can think of these modes as existing in a table:</p><table class="table table-borderless table-white"><thead><tr><td></td><th scope=col>Safe</th><th scope=col>Auto-resolved</th></tr></thead><tbody><tr><th scope=row>Bidirectional</th><td><code>two-way-safe</code></td><td><code>two-way-resolved</code></td></tr><tr><th scope=row>Unidirectional</th><td><code>one-way-safe</code></td><td><code>one-way-replica</code></td></tr></tbody></table><p>&ldquo;Safe&rdquo; in this case means that conflicts are only automatically resolved if they
don&rsquo;t result in the loss of unsynchronized data. &ldquo;Auto-resolved&rdquo; means that the
alpha endpoint wins any conflict, even if it involves deleting additional
unsynchronized content from beta.</p><p>These modes can be specified on a per-session basis by passing the
<code>-m/--sync-mode=&lt;mode&gt;</code> flag to the <code>mutagen sync create</code> command. These modes
can be specified on a default per-session basis by including the following
configuration in <code>~/.mutagen.yml</code>:</p><pre><code>sync:
  defaults:
    mode: &quot;&lt;mode&gt;&quot;
</code></pre><h3 id=conflict-resolution>Conflict resolution</h3><p>Conflicts (which can occur in <code>two-way-safe</code> and <code>one-way-safe</code> modes) can be
resolved manually by deleting the content on the endpoint which you wish to have
lose the conflict. Once deleted, the conflict will no longer exist since
deletions can be overwritten.</p><h2 id=endpoint-urls>Endpoint URLs</h2><p>Syncrhonization endpoint URLs are nothing more than pointers to local or remote
filesystem locations. The exact format for forwarding endpoint URLs is
<a href=/documentation/transports>transport-dependent</a>, but each contains a path
component identifying the filesystem location to be synchronized. Filesystem
locations can be directory hierarchies or individual files â Mutagen can
synchronize either.</p><p>Mutagen only applies a few restrictions to synchronization endpoints:</p><ul><li>Symbolic links aren&rsquo;t allowed as synchronization roots, though they can exist
as part of the parent path of a synchronization roots, and of course are
allowed to exist inside of synchronization roots.</li><li>Synchronization of directory hierarchies that span filesystem boundaries is
not allowed.</li></ul><p>In both cases, Mutagen will detect and warn about the condition.</p><h2 id=configuration>Configuration</h2><p>Synchronization configuration is extensive, with configuration options
controlling:</p><ul><li><a href=#modes>Synchronization modes</a></li><li><a href=ignores>Ignores</a></li><li><a href=permissions>Permissions</a></li><li><a href=symbolic-links>Symbolic links</a></li><li><a href=watching>Filesystem watching</a></li><li><a href=probing-and-scanning>Filesystem probing and scanning</a></li><li><a href=staging>File staging</a></li><li><a href=size-limits>Size limits</a></li></ul><h2 id=session-management>Session management</h2><p>Synchronization sessions are managed using the <code>mutagen sync</code> commands, namely
<code>create</code>, <code>list</code>, <code>monitor</code>, <code>flush</code>, <code>pause</code>, <code>resume</code>, and <code>terminate</code>.
Example usage for these commands can be found in the
<a href=../introduction/getting-started>Getting started</a> guide. The <code>create</code> command
comes with a number of flags that control the configuration of the sessions that
it creates, and the other synchronization session management commands all
include flags that control their behavior. For more information about a
particular command, use:</p><pre><code>mutagen sync &lt;command&gt; --help
</code></pre></div></div></div></div><footer class="mt-auto bg-light py-4"><div class=container><div class=row><div class="col-md-4 my-3"><strong class=text-dark>Â© 2016 â 2019 Mutagen IO, Inc.</strong><br><span class=text-muted>All rights reserved.</span><br><strong><a class=text-info href=mailto:hello@mutagen.io>hello@mutagen.io</a></strong></div><div class=col-md-8><div class=row><div class="col-md-4 my-3"><h6 class=text-dark>Resources</h6><ul class="nav flex-column"><li class=nav-item><a class="nav-link px-0 text-secondary" href=/documentation>Documentation</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://groups.google.com/forum/#!forum/mutagen-announce>Announcements</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://github.com/mutagen-io/mutagen/blob/master/SECURITY.md>Security</a></li></ul></div><div class="col-md-4 my-3"><h6 class=text-dark>Legal</h6><ul class="nav flex-column"><li class=nav-item><a class="nav-link px-0 text-secondary" href=/legal/licenses>Licenses</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=/legal/third-party-trademarks>Third-party trademarks</a></li></ul></div><div class="col-md-4 my-3"><h6 class=text-dark>Links</h6><ul class="nav flex-column"><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://twitter.com/mutagen_io>Twitter</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://spectrum.chat/mutagen>Spectrum</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://github.com/mutagen-io/mutagen>GitHub</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=#>Top of page â²</a></li></ul></div></div></div></div></div></footer></body></html>