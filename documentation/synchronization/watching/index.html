<!doctype html><html lang=en class=h-100><head><title>Watching | Mutagen</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel="shortcut icon" href=/img/favicon.png><script src=/js/bundle.3aeab2414d60a7503e5e48309329f68fc244713a80665f3baba323d52f60b764.js integrity="sha256-OuqyQU1gp1A&#43;Xkgwkyn2j8JEcTqAZl87q6Mj1S9gt2Q="></script><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Mukta|Roboto:300,400|Roboto+Mono"><link rel=stylesheet href=/scss/main.min.6cd9493828aaf9946db37459e87631b3e2fa26d368112903942cdcab8dcb259f.css integrity="sha256-bNlJOCiq&#43;ZRts3RZ6HYxs&#43;L6JtNoESkDlCzcq43LJZ8="></head><body class="d-flex flex-column h-100"><div class=flex-shrink-0><nav class="navbar navbar-expand-md navbar-light py-0"><div class=container><a class="navbar-brand mutagen-brand" href=/><img class="d-inline-block align-top logo" src=/img/logo.svg alt="Mutagen logo">
Mutagen</a>
<button class="navbar-toggler mr-2" type=button data-toggle=collapse data-target=#navigation-content aria-controls=navigation-content aria-expanded=false aria-label="Toggle navigation" style=border:none>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse" id=navigation-content><ul class="navbar-nav ml-auto"><li class="nav-item mr-3"><a class=nav-link href=/documentation/introduction/installation>Install</a></li><li class="nav-item mr-3"><a class=nav-link href=/documentation>Documentation</a></li><li class="nav-item mr-3"><a class=nav-link href=https://spectrum.chat/mutagen target=_blank>Spectrum</a></li><li class="nav-item mr-3"><a class=nav-link href=https://twitter.com/mutagen_io target=_blank>Twitter</a></li><li class=nav-item><a class=nav-link href=https://github.com/mutagen-io/mutagen target=_blank>GitHub</a></li></ul></div></div></nav><nav class="navbar navbar-expand-md navbar-dark bg-dark py-0"><div class=container><div class="collapse navbar-collapse" id=navigation-content><ul class="navbar-nav ml-auto"><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=introduction-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Introduction</a><div class=dropdown-menu aria-labelledby=introduction-dropdown><a class=dropdown-item href=/documentation/introduction>Overview</a>
<a class=dropdown-item href=/documentation/introduction/installation>Installation</a>
<a class=dropdown-item href=/documentation/introduction/getting-started>Getting started</a>
<a class=dropdown-item href=/documentation/introduction/daemon>Daemon</a>
<a class=dropdown-item href=/documentation/introduction/configuration>Configuration</a>
<a class=dropdown-item href=/documentation/introduction/names-labels-identifiers>Names, labels, and identifiers</a></div></li><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=transports-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Transports</a><div class=dropdown-menu aria-labelledby=transports-dropdown><a class=dropdown-item href=/documentation/transports>Overview</a>
<a class=dropdown-item href=/documentation/transports/local>Local</a>
<a class=dropdown-item href=/documentation/transports/ssh>SSH</a>
<a class=dropdown-item href=/documentation/transports/docker>Docker<sup>®</sup> containers</a></div></li><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=synchronization-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Synchronization</a><div class=dropdown-menu aria-labelledby=synchronization-dropdown><a class=dropdown-item href=/documentation/synchronization>Overview</a>
<a class=dropdown-item href=/documentation/synchronization/ignores>Ignores</a>
<a class=dropdown-item href=/documentation/synchronization/version-control-systems>Version control systems</a>
<a class=dropdown-item href=/documentation/synchronization/permissions>Permissions</a>
<a class=dropdown-item href=/documentation/synchronization/symbolic-links>Symbolic links</a>
<a class=dropdown-item href=/documentation/synchronization/watching>Watching</a>
<a class=dropdown-item href=/documentation/synchronization/probing-and-scanning>Probing and scanning</a>
<a class=dropdown-item href=/documentation/synchronization/staging>Staging</a>
<a class=dropdown-item href=/documentation/synchronization/size-limits>Size limits</a>
<a class=dropdown-item href=/documentation/synchronization/safety-mechanisms>Safety mechanisms</a></div></li><li class="nav-item dropdown mr-1"><a class="nav-link dropdown-toggle" href=# id=forwarding-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Forwarding</a><div class=dropdown-menu aria-labelledby=forwarding-dropdown><a class=dropdown-item href=/documentation/forwarding>Overview</a>
<a class=dropdown-item href=/documentation/forwarding/unix-domain-sockets>Unix domain sockets</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=orchestration-dropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Orchestration</a><div class=dropdown-menu aria-labelledby=orchestration-dropdown><a class=dropdown-item href=/documentation/orchestration>Overview</a>
<a class=dropdown-item href=/documentation/orchestration/configuration>Configuration</a>
<a class=dropdown-item href=/documentation/orchestration/example>Example</a></div></li></ul></div></div></nav><div class="container my-5"><div class=row><div class="d-none d-lg-block col-lg-3"><div class="sticky-top padded-sticky-top"><nav id=TableOfContents><ul><li><a href=#watching>Watching</a><ul><li><a href=#native-recursive-watching>Native recursive watching</a></li><li><a href=#polling>Polling</a></li><li><a href=#modes>Modes</a><ul><li><a href=#polling-interval>Polling interval</a></li></ul></li></ul></li></ul></nav></div></div><div id=content class="col-md-12 col-lg-9 mb-3"><h1 id=watching>Watching</h1><p>Mutagen uses filesystem watching to know when it should scan for and propagate
changes. Unfortunately, the filesystem watching landscape is <em>extremely</em> varied
in terms of implementation, efficiency, and robustness. Almost every platform
uses a completely different mechanism, many of which are unreliable or
non-scalable.</p><p>Some systems (namely macOS and Windows) provide native recursive watching
mechanisms that can monitor arbitrarily large directory hierarchies, though
their behavior when the location being watched is deleted or changed is somewhat
inconsistent, and Windows only supports using a directory as the root of such a
recursive watch.</p><p>Other systems (e.g. Linux<sup>®</sup> and BSD systems) provide mechanisms that
require a watch descriptor or file descriptor to be open for <em>every</em> file or
directory being watched in a directory hierarchy, which can quickly exhaust
system quotas for directories that might be used in development (e.g. imagine a
synchronization root containing a <code>node_modules</code> directory).</p><p>Mutagen takes a pragmatic approach to filesystem watching that attempts to
maximize reliability and responsiveness while avoiding exhaustion of system
resources or problematic behavior.</p><h2 id=native-recursive-watching>Native recursive watching</h2><p>On systems that natively support recursive filesystem watching, a watch is
established on either the synchronization root itself (on macOS) or the parent
directory of the synchronization root (on Windows) and events are filtered to
only those originating from the synchronization root. Because these systems can
behave strangely if the root of a watch is deleted, a regular (but very cheap)
polling mechanism is used to ensure that the watch root hasn&rsquo;t been deleted or
recreated. If a change to the watch root is detected, the watch is
re-established.</p><h2 id=polling>Polling</h2><p>On all other systems, a polling mechanism is used to avoid exhausting watch/file
descriptors. This polling mechanism is also used as a fallback in cases where
native watching mechanisms fail unrecoverably. On Linux, this polling is coupled
with a restricted set of native watches on the most recently updated contents,
allowing for low-latency change notifications for most workflows without
exhausting watch/file descriptors.</p><h2 id=modes>Modes</h2><p>Mutagen provides three different filesystem watching modes:</p><ul><li><strong><code>portable</code> (Default)</strong>: In this mode, Mutagen uses the most efficient
watching implementation possible for an endpoint. If some type of native
watching mechanism is available, it is used, otherwise pure poll-based
watching is used.</li><li><code>force-poll</code>: In this mode, Mutagen will always use its poll-based watching
implementation, even on systems that support native watching.</li><li><code>no-watch</code>: In this mode, Mutagen won&rsquo;t perform any filesystem watching, and
endpoints using this mode will not be able to trigger a synchronization cycle.
If this mode is used for the entire synchronization session, then a
synchronization cycle only occurs when the <code>mutagen sync flush</code> command is
used.</li></ul><p>These modes can be specified on a per-session and/or per-endpoint basis by
passing the <code>--watch-mode=&lt;mode&gt;</code> or <code>--watch-mode-(alpha|beta)=&lt;mode&gt;</code> flag,
respectively, to the <code>mutagen sync create</code> command. These modes can be specified
on a default per-session basis by including the following configuration in
<code>~/.mutagen.yml</code>:</p><pre><code>sync:
  defaults:
    watch:
      mode: &quot;&lt;mode&gt;&quot;
</code></pre><h3 id=polling-interval>Polling interval</h3><p>If using polling-based watching, the polling interval (which defaults to 10
seconds) can be specified on a per-session and/or per-endpoint basis by passing
the <code>--watch-polling-interval=&lt;interval&gt;</code> or
<code>--watch-polling-interval-(alpha|beta)=&lt;interval&gt;</code> flag, respectively, to the
<code>mutagen sync create</code> command (where <code>&lt;interval&gt;</code> is an integer value
representing seconds) and on a default per-session basis by including the
following configuration in <code>~/.mutagen.yml</code>:</p><pre><code>sync:
  defaults:
    watch:
      pollingInterval: &lt;interval&gt;
</code></pre></div></div></div></div><footer class="mt-auto bg-light py-4"><div class=container><div class=row><div class="col-md-4 my-3"><strong class=text-dark>© 2016 – 2019 Mutagen IO, Inc.</strong><br><span class=text-muted>All rights reserved.</span><br><strong><a class=text-info href=mailto:hello@mutagen.io>hello@mutagen.io</a></strong></div><div class=col-md-8><div class=row><div class="col-md-4 my-3"><h6 class=text-dark>Resources</h6><ul class="nav flex-column"><li class=nav-item><a class="nav-link px-0 text-secondary" href=/documentation>Documentation</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://groups.google.com/forum/#!forum/mutagen-announce>Announcements</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://github.com/mutagen-io/mutagen/blob/master/SECURITY.md>Security</a></li></ul></div><div class="col-md-4 my-3"><h6 class=text-dark>Legal</h6><ul class="nav flex-column"><li class=nav-item><a class="nav-link px-0 text-secondary" href=/legal/licenses>Licenses</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=/legal/third-party-trademarks>Third-party trademarks</a></li></ul></div><div class="col-md-4 my-3"><h6 class=text-dark>Links</h6><ul class="nav flex-column"><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://twitter.com/mutagen_io>Twitter</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://spectrum.chat/mutagen>Spectrum</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=https://github.com/mutagen-io/mutagen>GitHub</a></li><li class=nav-item><a class="nav-link px-0 text-secondary" href=#>Top of page ▲</a></li></ul></div></div></div></div></div></footer></body></html>