<!doctype html>
<html lang="en" class="h-100">
    <head>
        
        <title>
            
                Support for Docker® containers | Mutagen
            
        </title>

        
        <meta charset="utf-8">

        
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        
        <link rel="shortcut icon" href="/img/favicon.png">

        
        <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>

        
        <script src="/js/asciinema-player.js"></script>

        
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mukta|Roboto:300,400|Roboto+Mono">

        
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

        
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">

        
        <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">

        
        <link rel="stylesheet" href="/css/asciinema-player.css">

        
        
        <link rel="stylesheet" href="https://mutagen.io/sass/mutagen.min.9b222dd1d84a63648b0e047c53c211c76c3ad36feaf7bed5889a943ebb9f573a.css" integrity="sha256-myIt0dhKY2SLDgR8U8IRx2w602/q977ViJqUPrufVzo=">

        
        <script type="text/javascript">
            
            $(function () {
                $('[data-toggle="tooltip"]').tooltip()
            });
        </script>
    </head>
    <body class="d-flex flex-column h-100">
        <div class="flex-shrink-0">
            <nav class="navbar navbar-light navbar-expand-md">
                <div class="container">
                    <a class="navbar-brand" href="/">
                        <img class="d-inline-block align-top mutagen-navbar-logo" src="/img/logo_thick_light.svg" alt="Mutagen logo">
                        Mutagen
                    </a>
                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navigation-content" aria-controls="navigation-content" aria-expanded="false" aria-label="Toggle navigation">
                        <i class="fas fa-chevron-down"></i>
                    </button>
                    <div class="collapse navbar-collapse" id="navigation-content">
                        <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="/overview">Overview</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/documentation">Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="/documentation/installation">Install</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://github.com/havoc-io/mutagen">Source</a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>

<div class="container">
    <nav class="pt-4 pb-1" aria-label="breadcrumb">
    <ol class="breadcrumb">
        
        
            
        
            
        
        
        <li class="breadcrumb-item">
            <a href="https://mutagen.io/documentation/">Documentation</a>
        
        </li>
    
        
        
        <li class="breadcrumb-item">
            <a href="https://mutagen.io/documentation/transports/">Transports</a>
        
        </li>
    
        
        
        <li class="breadcrumb-item active" aria-current="page">
            Support for Docker® containers
        
        </li>
    
    </ol>
    
</nav>
    <div class="row">
        <div class="d-none d-lg-block col-lg-4">
            <div class="sticky-top" style="top:40px;">
                <nav id="TableOfContents">
<ul>
<li><a href="#support-for-docker-sup-sup-containers">Support for Docker<sup>®</sup> containers</a>
<ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#usage">Usage</a>
<ul>
<li><a href="#environment-variables">Environment variables</a></li>
<li><a href="#windows-containers">Windows containers</a></li>
</ul></li>
<li><a href="#mechanism-of-action">Mechanism of action</a></li>
<li><a href="#overriding-the-docker-executable-search-path">Overriding the Docker executable search path</a></li>
</ul></li>
</ul>
</nav>
            </div>
        </div>
        <div class="col-md-12 col-lg-8 mb-3">
            

<h1 id="support-for-docker-sup-sup-containers">Support for Docker<sup>®</sup> containers</h1>

<p>Mutagen has support for synchronizing with filesystems inside Docker<sup>®</sup>
containers. This support extends to all Docker client platforms
(Linux<sup>®</sup>, macOS, Windows, etc.), Docker daemon setups (local, remote,
VM, Hyper-V, etc.), and Docker container types (both Linux and Windows
containers are supported).</p>

<p><strong>NOTE:</strong> Mutagen&rsquo;s support for Docker containers is considered &ldquo;experimental&rdquo;
in the sense that it is new (less mature than SSH support), minimalist, and
designed for experimentation. It provides the basic primitives needed to enable
synchronization with containers, but it will be up to users to integrate this
into their individual orchestration tools and workflows. However, Mutagen wants
to help with this, so a
<a href="https://github.com/havoc-io/mutagen/issues/41">feedback issue</a>
has been opened for users to provide feedback on evolving Mutagen&rsquo;s support for
Docker containers. Please don&rsquo;t hesitate to submit your feedback on this issue,
no matter how small.</p>

<h2 id="requirements">Requirements</h2>

<p>Mutagen requires the <code>docker</code> command to be in the user&rsquo;s path. Due to its use
of the <code>-w/--workdir</code> flag with the <code>docker exec</code> command, Mutagen requires a
Docker client and daemon supporting API 1.35+. You can check the API version
support of your Docker client and daemon by using the <code>docker version</code> command.</p>

<p><strong>NOTE:</strong> Mutagen assumes that the transport from the <code>docker</code> command to the
Docker daemon is secure, and thus Mutagen provides no encryption on top of this
transport. For information about securing the Docker daemon, please see the
<a href="https://docs.docker.com/engine/security/https/">relevant documentation</a>.</p>

<h2 id="usage">Usage</h2>

<p>Docker container filesystem endpoints can be specified to Mutagen&rsquo;s <code>create</code>
command using URLs of the form:</p>

<pre><code>docker://[user@]container/path
</code></pre>

<p>These URLs support Unicode names and paths and neither require nor support URL
escape encoding (i.e. just type &ldquo;ö&rdquo;, not &ldquo;%C3%B6&rdquo;, etc.).</p>

<p>The <code>user</code> component is optional and tells Mutagen to act as the specified user
inside the container. If unspecified, Mutagen uses the default container user
(usually <code>root</code> for Linux containers or <code>ContainerAdministrator</code> for Windows
containers).</p>

<p>The <code>container</code> component can specify any type of container identifier
understood by <code>docker cp</code> and <code>docker exec</code>, e.g. a name or hexidecimal
identifier.</p>

<p>The <code>path</code> component must be non-empty (i.e. at least a <code>/</code> character) and can
take one of four forms: an absolute path, a home-directory-relative path, a
home-directory-relative path for an alternate user, or a Windows absolute path:</p>

<pre><code># Example absolute path (/var/www)
docker://container/var/www

# Example home-directory-relative path (~/project)
docker://container/~/project

# Example alternate user home-directory-relative path (~otheruser/project)
docker://container/~otheruser/project

# Example Windows absolute path (C:\path)
docker://container/C:\path
</code></pre>

<p>Docker containers must be running to create synchronization sessions and to
allow synchronization to run.</p>

<h3 id="environment-variables">Environment variables</h3>

<p>The Docker client&rsquo;s behavior is controlled by three environment variables:</p>

<ul>
<li><code>DOCKER_HOST</code></li>
<li><code>DOCKER_TLS_VERIFY</code></li>
<li><code>DOCKER_CERT_PATH</code></li>
</ul>

<p>Mutagen is aware of these environment variables and will lock them in at session
creation time (i.e. the <code>create</code> command will scan and store their values),
including locking in absent or empty values. These locked in values will then be
forwarded to any <code>docker</code> commands executed by Mutagen.</p>

<p>If required, endpoint-specific versions of these variables (prefixed with
<code>MUTAGEN_ALPHA_</code> or <code>MUTAGEN_BETA_</code>) can be used to override their values on a
per-endpoint basis. This would be necessary to (e.g.) create a synchronization
session between two Docker containers hosted on different Docker daemons. In
that case, single global values for <code>DOCKER_*</code> environment variables can&rsquo;t be
used (since it would apply to both endpoint URLs), and endpoint-specific
variables such as <code>MUTAGEN_ALPHA_DOCKER_HOST</code> or
<code>MUTAGEN_BETA_DOCKER_TLS_VERIFY</code> would need to be used when invoking
<code>mutagen create</code>.</p>

<h3 id="windows-containers">Windows containers</h3>

<p>Docker Windows containers are run using Microsoft&rsquo;s Hyper-V hypervisor, which
unfortunately does not allow <code>docker cp</code> operations to copy files into running
containers. This means that Mutagen has to stop and restart Windows containers
in order to copy its agent executables. Mutagen will prompt the user if this is
necessary and allow the user to abort or proceed. If the user decides to
proceed, the stop and restart will be automatically performed by Mutagen. This
is only necessary if a compatible agent binary doesn&rsquo;t already exist in the
container, so it won&rsquo;t be necessary on subsequent connection operations.</p>

<p>This restriction does not apply to Linux containers.</p>

<h2 id="mechanism-of-action">Mechanism of action</h2>

<p>Mutagen&rsquo;s support for Docker containers is provided by the Docker client
executable on your system. Mutagen uses the <code>docker cp</code> command to copy agent
binaries into containers and the <code>docker exec</code> command to run and communicate
with the agent binaries over standard input/output streams.</p>

<h2 id="overriding-the-docker-executable-search-path">Overriding the Docker executable search path</h2>

<p>Mutagen uses the first <code>docker</code> executable found in the user&rsquo;s path (and on
macOS includes a few other well-known search paths). This search strategy can be
overridden by setting the <code>MUTAGEN_DOCKER_PATH</code> environment variable (for the
Mutagen daemon) to a path containing the desired Docker client executable.</p>

        </div>
    </div>
</div>

        </div>
        <footer class="mt-auto">
            <div class="container py-3">
                <div class="row">
                    <div class="col-md-4 py-3 text-muted">
                        <strong>Copyright © 2016 – 2019 Jacob Howard.</strong><br />
                        All rights reserved.
                    </div>
                    <div class="col-md-2 offset-md-2 py-3">
                        <h4>Resources</h4>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="/documentation">Documentation</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://groups.google.com/forum/#!forum/mutagen-announce">Announcements</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://groups.google.com/forum/#!forum/mutagen">Forums</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://github.com/havoc-io/mutagen/blob/master/SECURITY.md">Security</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-2 py-3">
                        <h4>Legal</h4>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="/third-party-trademark-notices">Third-party trademarks</a>
                            </li>
                        </ul>
                    </div>
                    <div class="col-md-2 py-3">
                        <h4>Links</h4>
                        <ul class="nav flex-column">
                            <li class="nav-item">
                                <a class="nav-link active" href="https://github.com/havoc-io/mutagen">GitHub</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="https://twitter.com/mutagen_io">Twitter</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link active" href="#">Top of page <i class="fas fa-caret-up"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </footer>
    </body>
</html>
